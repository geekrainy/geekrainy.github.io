<!DOCTYPE html><html><head><meta charset="utf-8"><title>JavaScript 中的 Boolean 运算与 Boolean 对象 | 雨落</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="今天看到有人提出这样一个问题，下面是代码： 123var ob1 &#x3D; new Boolean(false);var ob2 &#x3D; ob1 &amp;&amp; true; &#x2F;&#x2F; truevar ob3 &#x3D; true &amp;&amp; ob1; &#x2F;&#x2F; false  很奇怪是吧，继续看第二个例子： 1234var a &#x3D; 2;var b &#x3D; 3;var andflag &#x3D; a &amp;&amp;"><meta property="og:type" content="article"><meta property="og:title" content="JavaScript 中的 Boolean 运算与 Boolean 对象"><meta property="og:url" content="https://rainylog.com/post/js-booleanObject-and-LogicalAND/index.html"><meta property="og:site_name" content="雨落"><meta property="og:description" content="今天看到有人提出这样一个问题，下面是代码： 123var ob1 &#x3D; new Boolean(false);var ob2 &#x3D; ob1 &amp;&amp; true; &#x2F;&#x2F; truevar ob3 &#x3D; true &amp;&amp; ob1; &#x2F;&#x2F; false  很奇怪是吧，继续看第二个例子： 1234var a &#x3D; 2;var b &#x3D; 3;var andflag &#x3D; a &amp;&amp;"><meta property="og:locale"><meta property="og:image" content="https://rainylog-1256215078.cos.ap-shanghai.myqcloud.com/images/example-1.jpg"><meta property="og:image" content="https://rainylog-1256215078.cos.ap-shanghai.myqcloud.com/images/example-2.jpg"><meta property="og:image" content="https://rainylog-1256215078.cos.ap-shanghai.myqcloud.com/images/example-3.jpg"><meta property="article:published_time" content="2015-12-22T11:30:06.000Z"><meta property="article:modified_time" content="2020-12-29T13:35:51.529Z"><meta property="article:author" content="Rainy"><meta property="article:tag" content="笔记"><meta property="article:tag" content="javascript"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://rainylog-1256215078.cos.ap-shanghai.myqcloud.com/images/example-1.jpg"><link rel="icon" href="/favicon.png"><link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-99171848-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-99171848-1")</script><link rel="stylesheet" href="/icomoon/style.css"><link rel="stylesheet" href="/style.css"><meta name="generator" content="Hexo 5.1.0"><link rel="alternate" href="/atom.xml" title="雨落" type="application/atom+xml">
</head><body><div class="site-wrapper"><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><script>document.getElementById("loading-bar").style.width="20%"</script><header id="header" class="site-header clearfix"><a class="logo square clearfix" href="/"><span class="b">雨 </span><span class="b">落 </span></a><a class="me square site-nav-switch clearfix"><span class="b"><span class="icon icon-menu"></span></span></a></header><script>document.getElementById("loading-bar").style.width="40%"</script><main id="main" class="clearfix"><article id="post-js-booleanObject-and-LogicalAND" class="article white-box article-type-post" itemscope itemprop="blogPost"><header class="article-header"><h1 class="article-title" itemprop="name">JavaScript 中的 Boolean 运算与 Boolean 对象</h1><div class="article-meta">Posted on <time class="article-time" datetime="2015-12-22T11:30:06.000Z" itemprop="datePublished">Dec 22, 2015</time></div></header><div class="article-entry" itemprop="articleBody"><p>今天看到有人提出这样一个问题，下面是代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ob1 = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="keyword">var</span> ob2 = ob1 &amp;&amp; <span class="literal">true</span>; <span class="comment">// true</span></span><br><span class="line"><span class="keyword">var</span> ob3 = <span class="literal">true</span> &amp;&amp; ob1; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>很奇怪是吧，继续看第二个例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">var</span> andflag = a &amp;&amp; b;</span><br><span class="line"><span class="keyword">var</span> orflag = a || b;</span><br></pre></td></tr></table></figure><p>问 andflag 和 orflag 的值各是多少。乍看，认为 andflag 和 orflag 的值均为 true。因为 &amp;&amp; 和 || 都是求 Boolean，众所周知，JavaScript 是弱类型的语言，会进行类型转换。<br>但答案是 andflag 为 3, orflag 为 2。</p><p>经过和朋友的讨论，查阅书籍，终于知道了原因，首先要说一下 &amp;&amp; 运算，在《JavaScript高级程序设计》中有这样的描述：</p><blockquote><p>逻辑与操作符可以应用于任何类型的操作数，而不仅仅是布尔值。在有一个操作数不是布尔值的情况下，逻辑与操作符就不一定返回布尔值；此时，它遵循下列规则：</p><ol><li>如果第一个操作数是对象，则返回第二个操作数；</li><li>如果第二个操作数是对象，则只有在第一个操作数的求值结果为 true 的情况下才会返回该对象；</li><li>如果两个操作数都是对象，则返回第二个操作数；</li><li>如果有一个操作数是 null/NaN/undefined，则返回 null/NaN/undefined。</li></ol></blockquote><p>在第一个例子中，ob1 是用 Boolean 构造函数创建的值为 false 的 Boolean 对象，所以依据上面的规则，第二行第一个操作数为对象，则返回 true。第三行第二个操作数是对象，第一个操作数为 true，所以结果返回该 Boolean 对象。<br>另外，这里的 ob3 为一个对象，alert() 会自动调用 toString() 方法，若要 console.log() 与 alert() 一致，则应显式调用 toString() 方法。</p><p><img src="https://rainylog-1256215078.cos.ap-shanghai.myqcloud.com/images/example-1.jpg" alt="例1" title="例1"></p><p>相比JS红皮书中的描述，犀牛书中的描述则更为明了，本质是相同的：</p><blockquote><p>&amp;&amp; 的操作数并不一定是布尔值，对其它类型的值（假值为 false、null、undefined、0、-0、NaN 和 “”，所有其它的值都是真值）也可因进行布尔操作。如果两个数都是真值，那么返回一个真值；否则，如果至少一个操作数是假值，则返回一个假值。进一步讲，运算符首先计算 &amp;&amp; 左侧的表达式。如果计算结果为假值，则 &amp;&amp; 返回左侧表达式的值，而不会对右操作数进行计算。如果左操作数是真值，&amp;&amp; 运算符将右操作数的值并将其返回作为整个表达式的运算结果。</p></blockquote><p>由此，第二个例子的答案就显而易见了。同理，对于逻辑或操作符，它首先计算第一个操作数的值，如果结果为真，则返回左操作数，否则计算第二个操作数，并返回第二个操作数。</p><p><img src="https://rainylog-1256215078.cos.ap-shanghai.myqcloud.com/images/example-2.jpg" alt="例2" title="例2"></p><p>逻辑与操作与逻辑或操作均属于<strong>短路</strong>操作。当 &amp;&amp; 右侧的表达式具有副作用（赋值、递增、递减和函数调用表达式）时，它们的执行依赖左操作数的计算结果。<br>下面的 JavaScript 代码是等价的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a == b) foo();</span><br><span class="line">(a == b) &amp;&amp; foo();</span><br></pre></td></tr></table></figure><p>而 || 最常用此特性的方式是为变量提供后备值或在函数中为参数提供默认值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myValue = preferredValue || backupValue;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    b = b || &#123;&#125;;  <span class="comment">// 如果没有向参数中传入任何对象，则使用新建的空对象</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将第一个例子改写下，得到第三个例子：</p><p><img src="https://rainylog-1256215078.cos.ap-shanghai.myqcloud.com/images/example-3.jpg" alt="例3" title="例3"></p><p>可以看到例一的运行结果与最初的期望一致了，这是因为在这里ob1不是一个对象，而是 boolean 值。使用 new 调用基本类型的构造函数，与直接调用同名的转型函数是不同的。下面是基本类型的布尔值与引用类型的布尔值的区别：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> trueValue = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> trueObject = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> trueValue); <span class="comment">// boolean</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> trueObject); <span class="comment">// object</span></span><br><span class="line"><span class="built_in">console</span>.log(trueValue <span class="keyword">instanceof</span> <span class="built_in">Boolean</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(trueObject <span class="keyword">instanceof</span> <span class="built_in">Boolean</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>通过以上讨论可以很自然的理解大多数 JavaScript 书籍和教程中指出的一点：</p><blockquote><p>我们的建议是永远不要使用 Boolean 对象。</p></blockquote><p>END</p><p>参考：</p><ol><li><em>《JavaScript高级程序设计》</em></li><li><em>《JavaScript权威指南》</em></li><li><em><a target="_blank" rel="noopener" href="http://www.pm-road.com/index.php/2014/09/13/102/">js中的逻辑与（&amp;&amp;）和逻辑或（||）</a></em></li></ol><div class="article-copyright"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external"><span class="icon icon-creative-commons"></span> <span>本博客所有文章除特别声明外，均采用 CC BY-NC-ND 4.0 许可协议。转载请注明出处！</span> </a><a href="https://rainylog.com">&copy; 雨落</a></div></div><div class="article-tags"><a class="tag-none-link" href="/tags/javascript/" rel="tag">javascript</a><a class="tag-none-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></div><nav class="article-nav clearfix"><a href="/post/githug-1/" class="article-nav-newer"><div class="article-nav-title">Githug 闯关式学习 git（一）</div></a><a href="/post/wsq-star/" class="article-nav-older"><div class="article-nav-title">友の星空</div></a></nav><section id="comments" class="white-box"></section></article><script>document.getElementById("loading-bar").style.width="60%"</script></main><footer id="footer" class="clearfix"><div class="search"><form name="searchform" id="searchform" class="u-search-form"><input type="text" id="searchinput" class="u-search-input st-default-search-input" data-list-highlight="true" data-list-value-completion="true" placeholder="Looking for something?"> <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit"><span class="icon icon-search"></span></button></form></div><div>&copy; <a href="https://rainylog.com">雨落</a> Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div><div>Powered by <a target="_blank" href="https://hexo.io/" rel="external noopener">Hexo</a>.</div></footer><script>document.getElementById("loading-bar").style.width="80%"</script><div class="overlay"></div></div><div class="site-sidebar"><div class="sidebar-switch clearfix" style="display:none"><a class="dark-btn active" data-toggle="toc"><span class="icon icon-list"></span> <span class="text">Index</span> </a><a class="dark-btn" data-toggle="bio"><span class="icon icon-person"></span> <span class="text">Bio</span></a></div><div class="site-toc" style="display:none"><div class="no-index">No Index</div></div><div class="site-bio show" style="display:block"><div class="about-me clearfix"><div class="avatar"><img src="/img/avatar.gif"></div><div class="info"><a class="name dark-btn" href="/about">Rainy</a></div><div class="info"><span class="item desc">沉淀，分享。</span></div></div><div class="social clearfix"><a href="/atom.xml" class="feed" target="_blank" rel="external"><span class="icon icon-feed"></span> </a><a href="mailto://geekrainy@gmail.com" class="email" target="_blank" rel="external"><span class="icon icon-mail"></span> </a><a href="https://github.com/geekrainy" class="github" target="_blank" rel="external"><span class="icon icon-github"></span> </a><a href="https://weibo.com/geekrainy" class="weibo" target="_blank" rel="external"><span class="icon icon-weibo"></span></a></div><div class="shortcuts clearfix"><div class="bk"><a href="#header" class="dark-btn window-nav"><span class="icon icon-chevron-thin-up"></span> <span class="text">Back to Top</span></a></div><div class="bk"><a href="#footer" class="dark-btn window-nav"><span class="icon icon-chevron-thin-down"></span> <span class="text">Go to Bottom</span></a></div></div></div></div><script type="text/javascript">var GOOGLE_CUSTOM_SEARCH_API_KEY="",GOOGLE_CUSTOM_SEARCH_ENGINE_ID="",ALGOLIA_API_KEY="",ALGOLIA_APP_ID="",ALGOLIA_INDEX_NAME="",AZURE_SERVICE_NAME="rainylog",AZURE_INDEX_NAME="rainylog",AZURE_QUERY_KEY="FDEE6CFE3AB9A25E574BBCB873B29595",BAIDU_API_ID="",SEARCH_SERVICE="azure"</script><script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="/js/jquery.js"><\/script>')</script><script src="/js/search.js"></script><script src="/js/app.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script type="text/javascript">var GUEST=["nick","mail","link"],guest="nick,mail,link";guest=guest.split(",").filter(function(e){return-1<GUEST.indexOf(e)}),new Valine({el:"#comments",verify:!0,notify:!0,appId:"H90zpiwhe0XxV8Kb8n6BplHo-MdYXbMMI",appKey:"974axFeQbAqLnxwJIRgc1xHa",placeholder:"Just go go",avatar:"retro",meta:guest,pageSize:10,visitor:!0})</script><script>document.getElementById("loading-bar").style.width="100%"</script></body></html>