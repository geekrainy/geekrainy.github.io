<!DOCTYPE html><html><head><meta charset="utf-8"><title>笔记本服务器改造踩坑 | 雨落</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="公司入职发了台 16G 内存的惠普笔记本，买了 Mac 之后一直闲置，在拖延许久之后终于抽时间将其换成 CentOS，来搞一些自己的服务放上面，毕竟 16G 内存还是很可观的配置。本篇讲述折腾过程。 安装 CentOS安装过程就不多说了，需要注意的就是关闭安全启动，启用传统模式（事实上启用之后是 UEFI 和传统模式混用，这种情况下 CentOS 会自动以 UEFI 模式进行安装）。这里有一个坑点"><meta property="og:type" content="article"><meta property="og:title" content="笔记本服务器改造踩坑"><meta property="og:url" content="https://rainylog.com/post/laptop-to-server/index.html"><meta property="og:site_name" content="雨落"><meta property="og:description" content="公司入职发了台 16G 内存的惠普笔记本，买了 Mac 之后一直闲置，在拖延许久之后终于抽时间将其换成 CentOS，来搞一些自己的服务放上面，毕竟 16G 内存还是很可观的配置。本篇讲述折腾过程。 安装 CentOS安装过程就不多说了，需要注意的就是关闭安全启动，启用传统模式（事实上启用之后是 UEFI 和传统模式混用，这种情况下 CentOS 会自动以 UEFI 模式进行安装）。这里有一个坑点"><meta property="og:locale"><meta property="article:published_time" content="2018-11-17T11:16:14.000Z"><meta property="article:modified_time" content="2020-12-29T13:35:51.529Z"><meta property="article:author" content="Rainy"><meta property="article:tag" content="Linux"><meta name="twitter:card" content="summary"><link rel="icon" href="/favicon.png"><link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-99171848-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-99171848-1")</script><link rel="stylesheet" href="/icomoon/style.css"><link rel="stylesheet" href="/style.css"><meta name="generator" content="Hexo 5.1.0"><link rel="alternate" href="/atom.xml" title="雨落" type="application/atom+xml">
</head><body><div class="site-wrapper"><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><script>document.getElementById("loading-bar").style.width="20%"</script><header id="header" class="site-header clearfix"><a class="logo square clearfix" href="/"><span class="b">雨 </span><span class="b">落 </span></a><a class="me square site-nav-switch clearfix"><span class="b"><span class="icon icon-menu"></span></span></a></header><script>document.getElementById("loading-bar").style.width="40%"</script><main id="main" class="clearfix"><article id="post-laptop-to-server" class="article white-box article-type-post" itemscope itemprop="blogPost"><header class="article-header"><h1 class="article-title" itemprop="name">笔记本服务器改造踩坑</h1><div class="article-meta">Posted on <time class="article-time" datetime="2018-11-17T11:16:14.000Z" itemprop="datePublished">Nov 17, 2018</time></div></header><div class="article-entry" itemprop="articleBody"><p>公司入职发了台 16G 内存的惠普笔记本，买了 Mac 之后一直闲置，在拖延许久之后终于抽时间将其换成 CentOS，来搞一些自己的服务放上面，毕竟 16G 内存还是很可观的配置。本篇讲述折腾过程。</p><h2 id="安装-CentOS"><a href="#安装-CentOS" class="headerlink" title="安装 CentOS"></a>安装 CentOS</h2><p>安装过程就不多说了，需要注意的就是关闭安全启动，启用传统模式（事实上启用之后是 UEFI 和传统模式混用，这种情况下 CentOS 会自动以 UEFI 模式进行安装）。这里有一个坑点在于如果在安装过程中选择无线连接，在安装完之后该连接无法启用。因为选择了最小化安装，网络管理相关的依赖是残缺的，所以需要在安装之后手动修复。</p><h2 id="命令行模式下的网络连接"><a href="#命令行模式下的网络连接" class="headerlink" title="命令行模式下的网络连接"></a>命令行模式下的网络连接</h2><p>首先查看网络设备：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# nmcli dev status</span><br><span class="line">DEVICE  TYPE      STATE        CONNECTION</span><br><span class="line">wlp2s0  wifi      unmanaged    --</span><br><span class="line">enp1s0  ethernet  unavailable  --</span><br><span class="line">lo      loopback  unmanaged    --</span><br></pre></td></tr></table></figure><p>证明无线网卡没有被管理，需要将其纳入网络管理。</p><p>安装 <code>NetworkManager-wifi</code> 包重启即可，由于在安装过程中连接过无线网，那么在 <code>/etc/sysconfig/network-scripts</code> 目录下可以看到 <code>ifcfg-[SSID]</code> 的配置文件，那么重启之后会用该文件连接 wifi 网络。</p><p>没有网络怎么安装依赖包呢？挂安装光盘起本地镜像就好，在 <code>/etc/yum.repos.d/CentOS-Media.repo</code> 中指定了本地镜像源的挂载位置，挂在到相应位置启用即可。</p><h2 id="设置公网访问"><a href="#设置公网访问" class="headerlink" title="设置公网访问"></a>设置公网访问</h2><p>电信提供公网 IP，在路由器中将该电脑设备设置为 DMZ 区设备即可利用公网 IP 访问，需要注意的是启用 DHCP 的话内网 IP 可能变化，要在路由器配置中将特定的固定 IP 地址与设备 MAC 进行绑定，如此便确保 DMZ 区的设备始终为该电脑设备。</p><h2 id="休眠问题"><a href="#休眠问题" class="headerlink" title="休眠问题"></a>休眠问题</h2><p>笔记本电脑合盖之后会自动休眠，需要进行配置，使其在合盖操作时依然保持运行状态。</p><p>编辑 <code>/etc/systemd/logind.conf</code> 文件，找到如下部分：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[Login]</span><br><span class="line"><span class="meta">#</span><span class="bash">NAutoVTs=6</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ReserveVT=6</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KillUserProcesses=no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KillOnlyUsers=</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KillExcludeUsers=root</span></span><br><span class="line"><span class="meta">#</span><span class="bash">InhibitDelayMaxSec=5</span></span><br><span class="line">HandlePowerKey=ignore # 按电源键时不做任何处理</span><br><span class="line"><span class="meta">#</span><span class="bash">HandleSuspendKey=<span class="built_in">suspend</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">HandleHibernateKey=hibernate</span></span><br><span class="line">HandleLidSwitch=ignore # 合上盖子时不做任何处理</span><br><span class="line"><span class="meta">#</span><span class="bash">HandleLidSwitchDocked=ignore</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PowerKeyIgnoreInhibited=no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">SuspendKeyIgnoreInhibited=no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">HibernateKeyIgnoreInhibited=no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">LidSwitchIgnoreInhibited=yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IdleAction=ignore</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IdleActionSec=30min</span></span><br><span class="line"><span class="meta">#</span><span class="bash">RuntimeDirectorySize=10%</span></span><br><span class="line"><span class="meta">#</span><span class="bash">RemoveIPC=no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UserTasksMax=</span></span><br></pre></td></tr></table></figure><p>这里对该文件有详细的描述：<a target="_blank" rel="noopener" href="https://www.freedesktop.org/software/systemd/man/logind.conf.html">https://www.freedesktop.org/software/systemd/man/logind.conf.html</a></p><p>到这里应该已经 OK 了，但是合上盖子后发现，即使通过局域网内进行 ssh 连接操作，都异常卡顿，网络连接非常慢。然而确实是可以连接上去的，服务器并没有休眠。这就让我开始怀疑除了上述控制休眠的设定之外，还有其他配置，猜测是由于电源管理的问题引起的。</p><p>由电源管理着手，搜寻资料，找到了一份<a target="_blank" rel="noopener" href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/pdf/power_management_guide/Red_Hat_Enterprise_Linux-7-Power_Management_Guide-zh-CN.pdf">《Red Hat Enterprise Linux 7 电源管理指南》</a>。在其中发现了管理无线设备的工具，RFKill。此处引用原文介绍：</p><blockquote><p>很多计算机系统包含无线电传输，其中包括 Wi-Fi、蓝牙和 3G 设备。这些设备消耗电源，在不使用这些设备时是一种浪费。<br>RFKill 是 Linux kernel 中的一个子系统，它可提供一个界面，在此界面中可查询、激活并取消激活计算机系统中的无线电传输。当取消激活传输时，可使其处于可被软件重新激活的状态（即“软锁定”）或者将其放在软件无法重新激活的位置（即“硬锁定”）。</p></blockquote><p>刚开始以为这就是原因，后来才发现该软件包和 BIOS 设定中的启用硬件设备一样，都是为了在电脑运行时停止启用某些设备。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# rfkill list</span><br><span class="line">0: hci0: Bluetooth</span><br><span class="line">	Soft blocked: no</span><br><span class="line">	Hard blocked: no</span><br><span class="line">1: phy0: Wireless LAN</span><br><span class="line">	Soft blocked: no</span><br><span class="line">	Hard blocked: no</span><br><span class="line">2: hp-wifi: Wireless LAN</span><br><span class="line">	Soft blocked: no</span><br><span class="line">	Hard blocked: no</span><br></pre></td></tr></table></figure><p>要么启用，要么禁用。这跟合上盖子启用网卡节能的现象不太相符。后来同样在该手册中，我发现了ASPM（Active-State Power Management，活动状态电源管理）。</p><blockquote><p>ASPM（Active-State Power Management，活动状态电源管理）能节省 PCI Express（PCIe，Peripheral Component Interconnect Express）子系统的电量，其原理为当 PCIe 连接没有处于使用状态时将其设定为低功率状态。ASPM 可以同时控制连接两端的电源状态，并且在连接终端的设备处于满电状态的情况下，仍然可以节电。</p></blockquote><p>看描述和我遇到的问题比较相符，在如下文件中可以看到 ASPM 的策略配置。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# cat /sys/module/pcie_aspm/parameters/policy</span><br><span class="line">[default] performance powersave</span><br></pre></td></tr></table></figure><p>在默认情况下，ASPM 是默认状态(default)，即根据固件设置设定 PCIe 连接的状态。在上述文件中去直接更改设置是不可以的，修改的话系统会报写保护，手册中提到可以在启动时作为内核参数配置，参考 <a target="_blank" rel="noopener" href="https://wiki.centos.org/zh/HowTos/Grub2">《在 CentOS 7 上设置 grub2》</a>尝试之：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# cat /etc/default/grub</span><br><span class="line">GRUB_TIMEOUT=5</span><br><span class="line">GRUB_DISTRIBUTOR=&quot;$(sed &#x27;s, release .*$,,g&#x27; /etc/system-release)&quot;</span><br><span class="line">GRUB_DEFAULT=saved</span><br><span class="line">GRUB_DISABLE_SUBMENU=true</span><br><span class="line">GRUB_TERMINAL_OUTPUT=&quot;console&quot;</span><br><span class="line">GRUB_CMDLINE_LINUX=&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet pcie_aspm=off&quot;</span><br><span class="line">GRUB_DISABLE_RECOVERY=&quot;true&quot;</span><br></pre></td></tr></table></figure><p>核心参数就是 <code>pcie_aspm=off</code>。重启之后测试，立竿见影，当我觉得问题解决的时候。过了一个小时，又歇菜了，又开始陷入了卡顿。</p><p>这时考虑，可能默认的固件设置还是会生效，只是相比较系统的设置而言没那么严格，遂决定尝试更改策略，而不是完全禁用。将 GRUB 配置中改为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX=&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet pcie_aspm.policy=performance&quot;</span><br></pre></td></tr></table></figure><p>一切运行 OK，只能说服务器发行版运行于个人 PC 时，还是有或多或少的水土不服的。</p><h2 id="2-小时后的更新"><a href="#2-小时后的更新" class="headerlink" title="2 小时后的更新"></a>2 小时后的更新</h2><p>本以为一切 OK 的时候，又出现了该问题，看来还是没有找到问题的根源。随后又将视线转向<a target="_blank" rel="noopener" href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/virtualization_tuning_and_optimization_guide/sect-virtualization_tuning_optimization_guide-tuned-tuned_and_tunedadm">TUNED 和 TUNED-ADM</a>。</p><blockquote><p>tuned 是一项配置文件调整机制，使 Red Hat Enterprise Linux 适应特定负载特性，例如 CPU 密集型任务要求，或存储／网络吞吐量的响应能力。<br>伴随它的工具 ktune 结合了 tuned-adm 工具，提供大量预先配置的调整分析，以便在大量具体使用案例中提高性能并降低能耗。编辑这些配置或者创建新配置可生成为系统定制的性能解决方案。</p></blockquote><p>系统内预设了一些 profile，通过这些 profile 可以快速选择性能的优化方案，查看 profile 列表：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# tuned-adm list</span><br><span class="line">Available profiles:</span><br><span class="line">- balanced                    - General non-specialized tuned profile</span><br><span class="line">- desktop                     - Optimize for the desktop use-case</span><br><span class="line">- latency-performance         - Optimize for deterministic performance at the cost of increased power consumption</span><br><span class="line">- network-latency             - Optimize for deterministic performance at the cost of increased power consumption, focused on low latency network performance</span><br><span class="line">- network-throughput          - Optimize for streaming network throughput, generally only necessary on older CPUs or 40G+ networks</span><br><span class="line">- powersave                   - Optimize for low power consumption</span><br><span class="line">- throughput-performance      - Broadly applicable tuning that provides excellent performance across a variety of common server workloads</span><br><span class="line">- virtual-guest               - Optimize for running inside a virtual guest</span><br><span class="line">- virtual-host                - Optimize for running KVM guests</span><br><span class="line">Current active profile: balanced</span><br></pre></td></tr></table></figure><p>在官网提供的配置列表中还有一项名为 sap 的配置，不得不感叹果真第一 ERP 系统，连红帽都为其做单独的优化配置。</p><p>默认启用的是 balanced，在能耗和性能之间尽可能达到最佳平衡，猜测可能对网络进行限制，于是我将其改为 <code>throughput-performance</code>，这将关闭节点并提高网络吞吐能力。更改之后需要重启 tuned 服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart tuned</span><br></pre></td></tr></table></figure><p>最好重启系统以使其运行在更改之后的配置下，重启之后验证，还是不行，遂决定禁用 tuned 服务再次验证。</p><p>禁用 tuned 服务执行如下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tuned-adm off</span><br></pre></td></tr></table></figure><p>并直接禁用 tuned 进程：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop tuned</span><br><span class="line">systemctl disable tuned</span><br></pre></td></tr></table></figure><p>重启之后验证，问题仍旧出现，让我想放弃用无线连接方式，买根网线改用有线方式了。不过由此过程找到的文档：<a target="_blank" rel="noopener" href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/virtualization_tuning_and_optimization_guide/">《虚拟化调试和优化指南》</a> 值得阅读。</p><h2 id="回头看网络管理"><a href="#回头看网络管理" class="headerlink" title="回头看网络管理"></a>回头看网络管理</h2><p>既然 Linux 本身通过 NetworkManager 来管理网络服务，在开头也是安装了 <code>NetworkManager-wifi</code> 包才能使用无线网络，那么有可能在网络管理这边就有相应的配置。在 windows 系统中同样在网卡设置中有相应的节能配置，因此查找资料，发现一个配置项。</p><blockquote><p>NetworkManager supports WiFi powersaving but the function is rather undocumented.</p><p>From the source code: wifi.powersave can have the following value:</p><p>NM_SETTING_WIRELESS_POWERSAVE_DEFAULT (0): use the default value<br>NM_SETTING_WIRELESS_POWERSAVE_IGNORE (1): don’t touch existing setting<br>NM_SETTING_WIRELESS_POWERSAVE_DISABLE (2): disable powersave<br>NM_SETTING_WIRELESS_POWERSAVE_ENABLE (3): enable powersave</p></blockquote><p>在 <code>/etc/NetworkManager/conf.d</code> 目录下新建文件 <code>wifi-powersave-off.conf</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[connection]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Values are 0 (use default), 1 (ignore/don<span class="string">&#x27;t touch), 2 (disable) or 3 (enable).</span></span></span><br><span class="line">wifi.powersave = 2</span><br></pre></td></tr></table></figure><p>将其关闭，重启网络服务，再次验证：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart NetworkManager</span><br></pre></td></tr></table></figure><h2 id="配置免密登录"><a href="#配置免密登录" class="headerlink" title="配置免密登录"></a>配置免密登录</h2><p>事实上 CentOS 7.4 之后，使用了 ssh 2.0 版本的协议，无需手动配置 sshd_config 来启用免密登录，默认是启用的。如果像之前那样配置 <code>RSAAuthentication yes</code> 选项，会在 <code>/var/log/secure</code> 记录中看到如下提示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nov 17 14:47:06 localhost sshd[11773]: reprocess config line 43: Deprecated option RSAAuthentication</span><br></pre></td></tr></table></figure><p>此次设置公钥之后，仍然无法登录，搜索资料有说是 SELinux 引起的，关闭 SELinux 仍然无法免密登录。查找许久后发现是我本地的 ssh 连接配置出现了问题。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Host 192.168.1.*</span><br><span class="line">  HostName %h</span><br><span class="line">  User root</span><br><span class="line">  IdentityFile ~/.ssh/xxx</span><br></pre></td></tr></table></figure><p>我的局域网连接恰好和该 ip 段重复，所以一直使用错误的密钥文件进行连接。</p><p>添加了一条特殊的 ip 配置之后，问题解决，由此也说明 ssh 的 config 文件配置具体 ip 的优先级要高于表达式匹配，无所谓配置在文件中的先后顺序。</p><p>至此，便可以快乐的玩耍这台小鸡了。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a target="_blank" rel="noopener" href="http://yangcongchufang.com/linux/redhat-linux-performance-guide.html">RedHat Linux 7 性能调优指南</a></li><li><a target="_blank" rel="noopener" href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/virtualization_tuning_and_optimization_guide/">《虚拟化调试和优化指南》</a></li><li><a target="_blank" rel="noopener" href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/pdf/power_management_guide/Red_Hat_Enterprise_Linux-7-Power_Management_Guide-zh-CN.pdf">《Red Hat Enterprise Linux 7 电源管理指南》</a></li><li><a target="_blank" rel="noopener" href="https://wiki.centos.org/zh/HowTos/Grub2">《在 CentOS 7 上设置 grub2》</a></li><li><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/269661/how-to-turn-off-wireless-power-management-permanently">How to turn off Wireless power management permanently</a></li></ul><p>-EOF-</p><div class="article-copyright"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external"><span class="icon icon-creative-commons"></span> <span>本博客所有文章除特别声明外，均采用 CC BY-NC-ND 4.0 许可协议。转载请注明出处！</span> </a><a href="https://rainylog.com">&copy; 雨落</a></div></div><div class="article-tags"><a class="tag-none-link" href="/tags/Linux/" rel="tag">Linux</a></div><nav class="article-nav clearfix"><a href="/post/install-k8s-on-centos7/" class="article-nav-newer"><div class="article-nav-title">CentOS7 单节点 k8s 部署拾遗</div></a><a href="/post/rainylog-upgrade-element/" class="article-nav-older"><div class="article-nav-title">雨落</div></a></nav><section id="comments" class="white-box"></section></article><script>document.getElementById("loading-bar").style.width="60%"</script></main><footer id="footer" class="clearfix"><div class="search"><form name="searchform" id="searchform" class="u-search-form"><input type="text" id="searchinput" class="u-search-input st-default-search-input" data-list-highlight="true" data-list-value-completion="true" placeholder="Looking for something?"> <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit"><span class="icon icon-search"></span></button></form></div><div>&copy; <a href="https://rainylog.com">雨落</a> Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div><div>Powered by <a target="_blank" href="https://hexo.io/" rel="external noopener">Hexo</a>.</div></footer><script>document.getElementById("loading-bar").style.width="80%"</script><div class="overlay"></div></div><div class="site-sidebar"><div class="sidebar-switch clearfix show" style="display:block"><a class="dark-btn active" data-toggle="toc"><span class="icon icon-list"></span> <span class="text">Index</span> </a><a class="dark-btn" data-toggle="bio"><span class="icon icon-person"></span> <span class="text">Bio</span></a></div><div class="site-toc show" style="display:block"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-CentOS"><span class="toc-number">1.</span> <span class="toc-text">安装 CentOS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.</span> <span class="toc-text">命令行模式下的网络连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%85%AC%E7%BD%91%E8%AE%BF%E9%97%AE"><span class="toc-number">3.</span> <span class="toc-text">设置公网访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%91%E7%9C%A0%E9%97%AE%E9%A2%98"><span class="toc-number">4.</span> <span class="toc-text">休眠问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%B0%8F%E6%97%B6%E5%90%8E%E7%9A%84%E6%9B%B4%E6%96%B0"><span class="toc-number">5.</span> <span class="toc-text">2 小时后的更新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E5%A4%B4%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86"><span class="toc-number">6.</span> <span class="toc-text">回头看网络管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95"><span class="toc-number">7.</span> <span class="toc-text">配置免密登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">8.</span> <span class="toc-text">参考</span></a></li></ol></div><div class="site-bio" style="display:none"><div class="about-me clearfix"><div class="avatar"><img src="/img/avatar.gif"></div><div class="info"><a class="name dark-btn" href="/about">Rainy</a></div><div class="info"><span class="item desc">沉淀，分享。</span></div></div><div class="social clearfix"><a href="/atom.xml" class="feed" target="_blank" rel="external"><span class="icon icon-feed"></span> </a><a href="mailto://geekrainy@gmail.com" class="email" target="_blank" rel="external"><span class="icon icon-mail"></span> </a><a href="https://github.com/geekrainy" class="github" target="_blank" rel="external"><span class="icon icon-github"></span> </a><a href="https://weibo.com/geekrainy" class="weibo" target="_blank" rel="external"><span class="icon icon-weibo"></span></a></div><div class="shortcuts clearfix"><div class="bk"><a href="#header" class="dark-btn window-nav"><span class="icon icon-chevron-thin-up"></span> <span class="text">Back to Top</span></a></div><div class="bk"><a href="#footer" class="dark-btn window-nav"><span class="icon icon-chevron-thin-down"></span> <span class="text">Go to Bottom</span></a></div></div></div></div><script type="text/javascript">var GOOGLE_CUSTOM_SEARCH_API_KEY="",GOOGLE_CUSTOM_SEARCH_ENGINE_ID="",ALGOLIA_API_KEY="",ALGOLIA_APP_ID="",ALGOLIA_INDEX_NAME="",AZURE_SERVICE_NAME="rainylog",AZURE_INDEX_NAME="rainylog",AZURE_QUERY_KEY="FDEE6CFE3AB9A25E574BBCB873B29595",BAIDU_API_ID="",SEARCH_SERVICE="azure"</script><script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="/js/jquery.js"><\/script>')</script><script src="/js/search.js"></script><script src="/js/app.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script type="text/javascript">var GUEST=["nick","mail","link"],guest="nick,mail,link";guest=guest.split(",").filter(function(e){return-1<GUEST.indexOf(e)}),new Valine({el:"#comments",verify:!0,notify:!0,appId:"H90zpiwhe0XxV8Kb8n6BplHo-MdYXbMMI",appKey:"974axFeQbAqLnxwJIRgc1xHa",placeholder:"Just go go",avatar:"retro",meta:guest,pageSize:10,visitor:!0})</script><script>document.getElementById("loading-bar").style.width="100%"</script></body></html>